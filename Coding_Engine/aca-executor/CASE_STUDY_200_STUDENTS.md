# Case Study: 200 Students, 2 Questions Each
## Complete System Architecture & Execution Flow

---

## ğŸ“Š **Scenario Overview**

- **Students**: 200
- **Questions per Student**: 2
- **Total Executions**: 400
- **Contest Duration**: 2 hours
- **Peak Load**: First 30 minutes (most submissions)

---

## ğŸ—ï¸ **System Architecture (Block Diagram)**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         CONTEST ENVIRONMENT                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  200 Students   â”‚
â”‚  (Browsers)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ HTTP Requests
         â”‚ (Code Submissions)
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    AZURE LOAD BALANCER                                  â”‚
â”‚  â€¢ Distributes requests across available replicas                      â”‚
â”‚  â€¢ Health checks                                                         â”‚
â”‚  â€¢ Auto-scaling triggers                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              AZURE CONTAINER APPS ENVIRONMENT                           â”‚
â”‚                    (ai-ta-RA-env)                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              CONTAINER APP: ai-ta-ra-code-executor2                     â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   Replica 1  â”‚  â”‚   Replica 2  â”‚  â”‚   Replica 3  â”‚  â”‚  Replica N â”‚ â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚  â”‚            â”‚ â”‚
â”‚  â”‚  Flask App   â”‚  â”‚  Flask App   â”‚  â”‚  Flask App   â”‚  â”‚ Flask App  â”‚ â”‚
â”‚  â”‚  (Port 8000) â”‚  â”‚  (Port 8000) â”‚  â”‚  (Port 8000) â”‚  â”‚ (Port 8000)â”‚ â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚  â”‚            â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â”‚
â”‚  â”‚  â”‚Request â”‚  â”‚  â”‚  â”‚Request â”‚  â”‚  â”‚  â”‚Request â”‚  â”‚  â”‚ â”‚Request â”‚â”‚ â”‚
â”‚  â”‚  â”‚ Queue  â”‚  â”‚  â”‚  â”‚ Queue  â”‚  â”‚  â”‚  â”‚ Queue  â”‚  â”‚  â”‚ â”‚ Queue  â”‚â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â”‚  â”‚  â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â”‚  â”‚  â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â”‚  â”‚ â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜â”‚ â”‚
â”‚  â”‚      â”‚       â”‚  â”‚      â”‚       â”‚  â”‚      â”‚       â”‚  â”‚     â”‚     â”‚ â”‚
â”‚  â”‚      â–¼       â”‚  â”‚      â–¼       â”‚  â”‚      â–¼       â”‚  â”‚     â–¼     â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚Code   â”‚  â”‚  â”‚  â”‚Code   â”‚  â”‚  â”‚  â”‚Code   â”‚  â”‚  â”‚ â”‚Code   â”‚  â”‚ â”‚
â”‚  â”‚  â”‚Exec   â”‚  â”‚  â”‚  â”‚Exec   â”‚  â”‚  â”‚  â”‚Exec   â”‚  â”‚  â”‚ â”‚Exec   â”‚  â”‚ â”‚
â”‚  â”‚  â”‚Engine â”‚  â”‚  â”‚  â”‚Engine â”‚  â”‚  â”‚  â”‚Engine â”‚  â”‚  â”‚ â”‚Engine â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                          â”‚
â”‚  Scaling: min_replicas=10, max_replicas=100                             â”‚
â”‚  Resources: 1.0 vCPU, 2.0 GiB per replica                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    EXECUTION PROCESS (Per Request)                       â”‚
â”‚                                                                          â”‚
â”‚  1. Request Received                                                    â”‚
â”‚     â”‚                                                                   â”‚
â”‚     â–¼                                                                   â”‚
â”‚  2. Rate Limiting Check (30 req/min per IP)                            â”‚
â”‚     â”‚                                                                   â”‚
â”‚     â–¼                                                                   â”‚
â”‚  3. Code Sanitization (AST + Regex + Obfuscation)                      â”‚
â”‚     â”‚                                                                   â”‚
â”‚     â–¼                                                                   â”‚
â”‚  4. Network Isolation (Block socket creation)                          â”‚
â”‚     â”‚                                                                   â”‚
â”‚     â–¼                                                                   â”‚
â”‚  5. Create Sandboxed Directory (/tmp/exec_*)                           â”‚
â”‚     â”‚                                                                   â”‚
â”‚     â–¼                                                                   â”‚
â”‚  6. Execute Code (Subprocess with Resource Limits)                     â”‚
â”‚     â”‚                                                                   â”‚
â”‚     â”œâ”€ Python: python3 -c <code>                                       â”‚
â”‚     â”œâ”€ JavaScript: node -e <code>                                      â”‚
â”‚     â”œâ”€ Java: javac + java Main                                          â”‚
â”‚     â””â”€ C++: g++ + ./main                                                â”‚
â”‚     â”‚                                                                   â”‚
â”‚     â–¼                                                                   â”‚
â”‚  7. Monitor Resources (CPU, Memory, Time)                             â”‚
â”‚     â”‚                                                                   â”‚
â”‚     â–¼                                                                   â”‚
â”‚  8. Compare Output with Expected Output                                â”‚
â”‚     â”‚                                                                   â”‚
â”‚     â–¼                                                                   â”‚
â”‚  9. Cleanup (Remove temp dirs, restore network)                        â”‚
â”‚     â”‚                                                                   â”‚
â”‚     â–¼                                                                   â”‚
â”‚  10. Return Result (JSON with test results)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    POSTGRESQL DATABASE                                  â”‚
â”‚  â€¢ Questions & Test Cases                                               â”‚
â”‚  â€¢ Execution Logs                                                       â”‚
â”‚  â€¢ Results Storage                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ˆ **Traffic Flow & Queue Management**

### **Traffic Distribution Over Time**

```
Requests per Minute
â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   â•±               â•²
â”‚                  â•±                 â•²
â”‚                 â•±                   â•²
â”‚                â•±                     â•²
â”‚               â•±                       â•²
â”‚              â•±                         â•²
â”‚             â•±                           â•²
â”‚            â•±                             â•²
â”‚           â•±                               â•²
â”‚          â•±                                 â•²
â”‚         â•±                                   â•²
â”‚        â•±                                     â•²
â”‚       â•±                                       â•²
â”‚      â•±                                         â•²
â”‚     â•±                                           â•²
â”‚    â•±                                             â•²
â”‚   â•±                                               â•²
â”‚  â•±                                                 â•²
â”‚ â•±                                                   â•²
â”‚â•±                                                     â•²
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Time
  0min   30min   60min   90min   120min

Peak: ~50-80 requests/minute (first 30 min)
Steady: ~10-20 requests/minute (remaining time)
```

### **Queue Management Strategy**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    REQUEST QUEUE FLOW                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Student Request
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Load Balancer  â”‚  â† Distributes across replicas
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â”€â”€â–º Replica 1 â”€â”€â”
         â”œâ”€â”€â”€â–º Replica 2 â”€â”€â”¤
         â”œâ”€â”€â”€â–º Replica 3 â”€â”€â”¤
         â”œâ”€â”€â”€â–º Replica 4 â”€â”€â”¤
         â”œâ”€â”€â”€â–º Replica 5 â”€â”€â”¤
         â”œâ”€â”€â”€â–º Replica 6 â”€â”€â”¤
         â”œâ”€â”€â”€â–º Replica 7 â”€â”€â”¤
         â”œâ”€â”€â”€â–º Replica 8 â”€â”€â”¤
         â”œâ”€â”€â”€â–º Replica 9 â”€â”€â”¤
         â””â”€â”€â”€â–º Replica 10 â”€â”˜
                â”‚
                â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Flask Queue â”‚  â† In-memory request queue per replica
         â”‚ (per replica)â”‚
         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  Worker     â”‚  â† Gunicorn workers (1 per replica)
         â”‚  Process    â”‚
         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  Execute    â”‚  â† Code execution (subprocess)
         â”‚  Code       â”‚
         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  Return     â”‚  â† Response to student
         â”‚  Result     â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âš¡ **Execution Timeline (Per Student)**

```
Student Journey (2 Questions)

Time: 0:00 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º 2:00

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Student 1                                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  [Login] â”€â”€â–º [Select Q1] â”€â”€â–º [Write Code] â”€â”€â–º [Submit]        â”‚
â”‚     â”‚            â”‚              â”‚                â”‚             â”‚
â”‚     â”‚            â”‚              â”‚                â–¼             â”‚
â”‚     â”‚            â”‚              â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚     â”‚            â”‚              â”‚         â”‚ Execution    â”‚    â”‚
â”‚     â”‚            â”‚              â”‚         â”‚ (2-5 sec)     â”‚    â”‚
â”‚     â”‚            â”‚              â”‚         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚     â”‚            â”‚              â”‚                â”‚             â”‚
â”‚     â”‚            â”‚              â”‚                â–¼             â”‚
â”‚     â”‚            â”‚              â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚     â”‚            â”‚              â”‚         â”‚ View Results â”‚    â”‚
â”‚     â”‚            â”‚              â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚     â”‚            â”‚              â”‚                              â”‚
â”‚     â”‚            â”‚              â”‚                              â”‚
â”‚     â”‚            â”‚              â–¼                              â”‚
â”‚     â”‚            â”‚         [Select Q2] â”€â”€â–º [Write Code]      â”‚
â”‚     â”‚            â”‚                â”‚              â”‚             â”‚
â”‚     â”‚            â”‚                â”‚              â–¼             â”‚
â”‚     â”‚            â”‚                â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚     â”‚            â”‚                â”‚         â”‚ Execution    â”‚ â”‚
â”‚     â”‚            â”‚                â”‚         â”‚ (2-5 sec)     â”‚ â”‚
â”‚     â”‚            â”‚                â”‚         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚     â”‚            â”‚                â”‚                â”‚         â”‚
â”‚     â”‚            â”‚                â”‚                â–¼         â”‚
â”‚     â”‚            â”‚                â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚     â”‚            â”‚                â”‚         â”‚ View Results â”‚ â”‚
â”‚     â”‚            â”‚                â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚     â”‚            â”‚                â”‚                          â”‚
â”‚     â–¼            â–¼                â–¼                          â”‚
â”‚  [Logout]                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Average Time per Question: 10-15 minutes
Total Time per Student: 20-30 minutes
```

---

## ğŸ”„ **Scaling Behavior**

### **Auto-Scaling Timeline**

```
Replicas
â”‚
â”‚ 100 â”¤                                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     â”‚                                          â•±           â•²
â”‚  80 â”¤                                         â•±             â•²
â”‚     â”‚                                        â•±               â•²
â”‚  60 â”¤                                       â•±                 â•²
â”‚     â”‚                                      â•±                   â•²
â”‚  40 â”¤                                     â•±                     â•²
â”‚     â”‚                                    â•±                       â•²
â”‚  20 â”¤                                   â•±                         â•²
â”‚     â”‚                                  â•±                           â•²
â”‚  10 â”¤â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•±                             â•²
â”‚     â”‚                                                               â•²
â”‚   0 â”¤                                                                â•²â”€â”€â”€â”€â”€â”€â”€â”€â”€
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Time
     0min   5min   10min   15min   20min   25min   30min   60min   90min   120min

Phase 1 (0-5 min):   Scale up from 10 â†’ 50 replicas
Phase 2 (5-30 min):   Peak load: 50-80 replicas
Phase 3 (30-60 min):  Steady state: 20-30 replicas
Phase 4 (60-120 min): Wind down: 10-20 replicas
Phase 5 (120+ min):   Scale down to 0 replicas (idle)
```

### **Scaling Triggers**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    AUTO-SCALING LOGIC                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Metrics Monitored:
  â€¢ CPU Usage (per replica)
  â€¢ Memory Usage (per replica)
  â€¢ Request Rate (requests/second)
  â€¢ Response Time (p95 latency)

Scaling Rules:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Scale UP when:                                               â”‚
  â”‚  â€¢ CPU > 70% for 30 seconds                                 â”‚
  â”‚  â€¢ Memory > 80% for 30 seconds                               â”‚
  â”‚  â€¢ Request queue > 10 pending requests                      â”‚
  â”‚  â€¢ Response time > 2 seconds (p95)                          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Scale DOWN when:                                             â”‚
  â”‚  â€¢ CPU < 30% for 5 minutes                                  â”‚
  â”‚  â€¢ Memory < 50% for 5 minutes                              â”‚
  â”‚  â€¢ Request queue < 2 pending requests                       â”‚
  â”‚  â€¢ Response time < 500ms (p95)                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Scale Speed:
  â€¢ Scale UP: 2-3 replicas per minute (fast)
  â€¢ Scale DOWN: 1 replica per 2 minutes (slow, to avoid thrashing)
```

---

## ğŸ“Š **Resource Allocation**

### **Per Execution Resources**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              RESOURCE ALLOCATION PER EXECUTION                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Subprocess Limits (per execution):
  â€¢ CPU Time: 10 seconds max
  â€¢ Memory: 256MB max
  â€¢ Processes: 5 max
  â€¢ File Size: 10MB max
  â€¢ Execution Timeout: 5-10 seconds

Container Resources (per replica):
  â€¢ CPU: 1.0 vCPU (shared across executions)
  â€¢ Memory: 2.0 GiB (shared across executions)
  â€¢ Concurrent Executions: ~4-8 per replica (depending on code complexity)

Total Capacity:
  â€¢ 10 replicas (min): ~40-80 concurrent executions
  â€¢ 100 replicas (max): ~400-800 concurrent executions
  â€¢ 400 total executions: Can handle in ~5-10 minutes at peak
```

### **Resource Usage Over Time**

```
CPU Usage (%)
â”‚
â”‚ 100 â”¤                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     â”‚                   â•±               â•²
â”‚  80 â”¤                  â•±                 â•²
â”‚     â”‚                 â•±                   â•²
â”‚  60 â”¤                â•±                     â•²
â”‚     â”‚               â•±                       â•²
â”‚  40 â”¤              â•±                         â•²
â”‚     â”‚             â•±                           â•²
â”‚  20 â”¤â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•±                             â•²â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚     â”‚                                            â•²
â”‚   0 â”¤                                             â•²â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Time
     0min   30min   60min   90min   120min

Memory Usage (%)
â”‚
â”‚ 100 â”¤                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     â”‚                   â•±               â•²
â”‚  80 â”¤                  â•±                 â•²
â”‚     â”‚                 â•±                   â•²
â”‚  60 â”¤                â•±                     â•²
â”‚     â”‚               â•±                       â•²
â”‚  40 â”¤              â•±                         â•²
â”‚     â”‚             â•±                           â•²
â”‚  20 â”¤â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•±                             â•²â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚     â”‚                                            â•²
â”‚   0 â”¤                                             â•²â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Time
     0min   30min   60min   90min   120min
```

---

## ğŸš€ **Execution Flow (Detailed)**

### **Step-by-Step Process**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              DETAILED EXECUTION FLOW                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. STUDENT SUBMITS CODE
   â”‚
   â”œâ”€â–º Request: POST /execute
   â”‚   {
   â”‚     "language": "python",
   â”‚     "code": "def solve(): ...",
   â”‚     "test_cases": [...],
   â”‚     "user_id": "student_123",
   â”‚     "question_id": "q1"
   â”‚   }
   â”‚
   â–¼

2. LOAD BALANCER
   â”‚
   â”œâ”€â–º Routes to least-loaded replica
   â”œâ”€â–º Health check: Replica is healthy
   â””â”€â–º Forward request to replica
   â”‚
   â–¼

3. REPLICA RECEIVES REQUEST
   â”‚
   â”œâ”€â–º Flask app receives request
   â”œâ”€â–º Rate limiting check: 30 req/min per IP
   â”œâ”€â–º Extract: language, code, test_cases, user_id, question_id
   â””â”€â–º Generate: execution_id, submission_id
   â”‚
   â–¼

4. CODE SANITIZATION
   â”‚
   â”œâ”€â–º AST Analysis (Python only)
   â”‚   â””â”€â–º Check for dangerous imports/functions
   â”œâ”€â–º Regex Pattern Matching
   â”‚   â””â”€â–º Block: os, subprocess, sys, eval, exec
   â”œâ”€â–º Obfuscation Detection
   â”‚   â””â”€â–º Flag suspicious patterns
   â””â”€â–º Network Operations Check
       â””â”€â–º Block: socket, requests, urllib
   â”‚
   â”œâ”€â–º If unsafe: Return error (400)
   â””â”€â–º If safe: Continue
   â”‚
   â–¼

5. NETWORK ISOLATION
   â”‚
   â”œâ”€â–º Block socket creation
   â””â”€â–º Store original socket for restoration
   â”‚
   â–¼

6. CREATE SANDBOXED DIRECTORY
   â”‚
   â”œâ”€â–º Create: /tmp/exec_<uuid>/
   â”œâ”€â–º Set permissions: 700 (owner only)
   â””â”€â–º Set as working directory
   â”‚
   â–¼

7. EXECUTE CODE (Per Test Case)
   â”‚
   â”œâ”€â–º For each test case:
   â”‚   â”‚
   â”‚   â”œâ”€â–º Get input (from string or file)
   â”‚   â”œâ”€â–º Get expected output (from string or file)
   â”‚   â”‚
   â”‚   â”œâ”€â–º Create subprocess with resource limits:
   â”‚   â”‚   â”œâ”€â–º CPU: 10 seconds max
   â”‚   â”‚   â”œâ”€â–º Memory: 256MB max
   â”‚   â”‚   â”œâ”€â–º Processes: 5 max
   â”‚   â”‚   â””â”€â–º Timeout: 5-10 seconds
   â”‚   â”‚
   â”‚   â”œâ”€â–º Execute code:
   â”‚   â”‚   â”œâ”€â–º Python: python3 -c <code>
   â”‚   â”‚   â”œâ”€â–º JavaScript: node -e <code>
   â”‚   â”‚   â”œâ”€â–º Java: javac Main.java && java Main
   â”‚   â”‚   â””â”€â–º C++: g++ main.cpp && ./main
   â”‚   â”‚
   â”‚   â”œâ”€â–º Monitor resources:
   â”‚   â”‚   â”œâ”€â–º CPU usage (psutil)
   â”‚   â”‚   â”œâ”€â–º Memory usage (psutil)
   â”‚   â”‚   â””â”€â–º Execution time
   â”‚   â”‚
   â”‚   â”œâ”€â–º Capture output:
   â”‚   â”‚   â”œâ”€â–º stdout (actual output)
   â”‚   â”‚   â””â”€â–º stderr (errors)
   â”‚   â”‚
   â”‚   â””â”€â–º Compare output:
   â”‚       â”œâ”€â–º Normalize (trim whitespace)
   â”‚       â””â”€â–º Compare: actual vs expected
   â”‚
   â–¼

8. AGGREGATE RESULTS
   â”‚
   â”œâ”€â–º Calculate:
   â”‚   â”œâ”€â–º Total tests: N
   â”‚   â”œâ”€â–º Passed: X
   â”‚   â”œâ”€â–º Failed: Y
   â”‚   â”œâ”€â–º Pass percentage: (X/N) * 100
   â”‚   â””â”€â–º All passed: X == N
   â”‚
   â”œâ”€â–º Aggregate metrics:
   â”‚   â”œâ”€â–º Total execution time
   â”‚   â”œâ”€â–º Average CPU usage
   â”‚   â””â”€â–º Max memory usage
   â”‚
   â–¼

9. CLEANUP
   â”‚
   â”œâ”€â–º Remove temp directory
   â”œâ”€â–º Restore network access
   â””â”€â–º Log execution (Azure Monitor)
   â”‚
   â–¼

10. RETURN RESULT
    â”‚
    â””â”€â–º Response: JSON
        {
          "execution_id": "...",
          "submission_id": "...",
          "summary": {
            "total_tests": 3,
            "passed": 3,
            "failed": 0,
            "all_passed": true,
            "pass_percentage": 100.0
          },
          "test_results": [...],
          "metadata": {
            "execution_time_ms": 234,
            "cpu_usage_percent": 15.2,
            "memory_usage_mb": 45.3
          }
        }
```

---

## ğŸ“ˆ **Performance Metrics**

### **Expected Performance**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PERFORMANCE METRICS                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Per Execution:
  â€¢ Average Execution Time: 2-5 seconds
  â€¢ P95 Execution Time: 5-8 seconds
  â€¢ P99 Execution Time: 8-10 seconds
  â€¢ Timeout Rate: < 1%
  â€¢ Error Rate: < 2%

System-Wide (Peak Load):
  â€¢ Throughput: 50-80 executions/minute
  â€¢ Concurrent Executions: 200-400
  â€¢ Average Response Time: 3-6 seconds
  â€¢ P95 Response Time: 8-12 seconds
  â€¢ Success Rate: > 98%

Resource Utilization:
  â€¢ CPU Usage: 60-80% (peak), 20-40% (steady)
  â€¢ Memory Usage: 70-90% (peak), 40-60% (steady)
  â€¢ Network: Minimal (no outbound traffic)
```

### **Timeline for 400 Executions**

```
Execution Completion
â”‚
â”‚ 400 â”¤                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     â”‚                                   â•±               â•²
â”‚ 300 â”¤                                  â•±                 â•²
â”‚     â”‚                                 â•±                   â•²
â”‚ 200 â”¤                                â•±                     â•²
â”‚     â”‚                               â•±                       â•²
â”‚ 100 â”¤                              â•±                         â•²
â”‚     â”‚                             â•±                           â•²
â”‚   0 â”¤â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•±                             â•²â”€â”€â”€â”€â”€â”€â”€â”€
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Time
     0min   10min   20min   30min   40min   50min   60min   70min   80min

Peak Period (0-30 min):
  â€¢ 300 executions completed (75%)
  â€¢ 50-80 executions/minute

Steady Period (30-60 min):
  â€¢ 80 executions completed (20%)
  â€¢ 10-20 executions/minute

Wind Down (60-80 min):
  â€¢ 20 executions completed (5%)
  â€¢ 5-10 executions/minute

Total Time: ~80 minutes for all 400 executions
```

---

## ğŸ’° **Cost Analysis**

### **Resource Costs**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    COST BREAKDOWN                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Container App Environment:
  â€¢ Base Cost: $0.000012/vCPU-second, $0.000015/GiB-second
  â€¢ Data Transfer: $0.05/GB (outbound)

Contest Scenario (2 hours):
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Phase 1 (0-30 min): Peak Load                               â”‚
  â”‚  â€¢ Replicas: 50-80                                           â”‚
  â”‚  â€¢ vCPU-seconds: 50 * 1.0 * 1800 = 90,000                   â”‚
  â”‚  â€¢ GiB-seconds: 50 * 2.0 * 1800 = 180,000                    â”‚
  â”‚  â€¢ Cost: ~$1.08 + $2.70 = $3.78                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Phase 2 (30-60 min): Steady State                            â”‚
  â”‚  â€¢ Replicas: 20-30                                           â”‚
  â”‚  â€¢ vCPU-seconds: 25 * 1.0 * 1800 = 45,000                    â”‚
  â”‚  â€¢ GiB-seconds: 25 * 2.0 * 1800 = 90,000                     â”‚
  â”‚  â€¢ Cost: ~$0.54 + $1.35 = $1.89                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Phase 3 (60-120 min): Wind Down                              â”‚
  â”‚  â€¢ Replicas: 10-20                                           â”‚
  â”‚  â€¢ vCPU-seconds: 15 * 1.0 * 3600 = 54,000                     â”‚
  â”‚  â€¢ GiB-seconds: 15 * 2.0 * 3600 = 108,000                    â”‚
  â”‚  â€¢ Cost: ~$0.65 + $1.62 = $2.27                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Total Contest Cost: ~$7.94
Per Student Cost: ~$0.04
Per Execution Cost: ~$0.02

Monthly Cost (if running 24/7 with min_replicas=0):
  â€¢ Idle: ~$0 (scaled to 0)
  â€¢ Active: ~$6-15/month (depending on usage)
```

---

## ğŸ›¡ï¸ **Security & Isolation**

### **Isolation Levels**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ISOLATION GUARANTEES                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Level 1: Container-to-Container
  âœ… Fully Isolated
  â€¢ Each container runs in separate environment
  â€¢ No access to other containers
  â€¢ Azure enforces isolation

Level 2: Container-to-Host
  âœ… Fully Isolated
  â€¢ Containers cannot access host system
  â€¢ No host filesystem access
  â€¢ Azure enforces isolation

Level 3: Execution-to-Execution (within container)
  âš ï¸ Partially Isolated
  â€¢ Each execution in separate subprocess
  â€¢ Isolated temp directories
  â€¢ Resource limits per execution
  â€¢ If code breaks out, could affect other executions in same container

Level 4: Student-to-Student
  âœ… Fully Isolated
  â€¢ Each student's code runs in separate execution
  â€¢ No access to other students' code
  â€¢ No shared state
```

---

## âœ… **Success Criteria**

### **System Requirements**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SUCCESS CRITERIA                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Performance:
  âœ… Handle 400 executions in 2 hours
  âœ… Average response time < 6 seconds
  âœ… P95 response time < 12 seconds
  âœ… Success rate > 98%
  âœ… Timeout rate < 1%

Scalability:
  âœ… Auto-scale from 10 to 100 replicas
  âœ… Handle peak load (50-80 req/min)
  âœ… Scale down gracefully after contest

Security:
  âœ… Code sanitization blocks malicious code
  âœ… Resource limits prevent exhaustion
  âœ… Network isolation prevents data exfiltration
  âœ… Container isolation protects host

Reliability:
  âœ… No system crashes
  âœ… Graceful error handling
  âœ… Automatic retry for transient failures
  âœ… Health checks ensure availability
```

---

## ğŸ¯ **Summary**

### **Key Points**

1. **Architecture**: Load balancer â†’ Container App â†’ Multiple replicas â†’ Code execution
2. **Scaling**: Auto-scales from 10 to 100 replicas based on load
3. **Queue**: In-memory queue per replica, distributed across replicas
4. **Isolation**: Container-level isolation protects host and other containers
5. **Performance**: Handles 400 executions in ~80 minutes
6. **Cost**: ~$8 per contest (~$0.04 per student)

### **Why It Works Smoothly**

1. **Auto-Scaling**: Automatically adjusts to load
2. **Load Balancing**: Distributes requests evenly
3. **Resource Limits**: Prevents resource exhaustion
4. **Queue Management**: Handles bursts gracefully
5. **Isolation**: Prevents interference between executions
6. **Monitoring**: Tracks performance and scales accordingly

---

**This architecture can smoothly handle 200 students with 2 questions each!** ğŸ‰


